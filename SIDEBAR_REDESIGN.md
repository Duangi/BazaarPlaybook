# 🎮 侧边栏系统重构完成

## 📋 系统概览

全新的现代化侧边栏界面已经完成！采用"左侧导航 + 右侧内容"的游戏化布局设计。

## ✨ 核心特性

### 1. 左侧导航栏 (Nav Rail)
- **极窄设计**：仅 56px 宽，节省空间
- **图标导航**：使用 emoji 图标，直观易懂
- **6大功能模块**：
  - 📋 怪物一览
  - 🎴 卡牌识别
  - 🎯 手头物品
  - 📚 百科搜索
  - 🧠 阵容推荐
  - 📊 策略分析

### 2. 水平滚动天数选择器
- **胶囊式设计**：圆角药丸形状
- **水平滚动**：不占用垂直空间
- **高亮选中**：金色渐变效果
- **Day 1 ~ Day 10+**：完整覆盖所有天数

### 3. 可展开的怪物卡片
- **紧凑默认视图**：头像 + 名称 + 血量条
- **悬浮高亮**：金色左边框 + 背景加亮
- **点击展开**：显示推荐出装和详情按钮
- **玻璃拟态**：半透明背景 + 细金边

### 4. 全局缩放系统 ⭐
- **滑块调节**：0.5x ~ 2.0x 自由缩放
- **实时预览**：调整即生效
- **持久化保存**：记住用户偏好
- **完美适配**：所有元素同步缩放

### 5. 一键识别按钮
- **扫光渐变**：金色流光效果
- **视觉焦点**：45px 高度，显著突出
- **状态反馈**：识别中会有动画（待实现）

## 🏗️ 架构设计

```
SidebarWindow (380x850)
├─ NavRail (56px 宽)
│  ├─ Logo 图标
│  ├─ 6个导航按钮
│  ├─ 弹簧
│  ├─ 设置按钮
│  └─ 自检按钮
│
└─ ContentArea
   ├─ TopBar (50px 高)
   │  ├─ 标题 "集市小抄"
   │  ├─ 收起按钮
   │  └─ 关闭按钮
   │
   └─ ContentStack (堆叠页面)
      ├─ MonsterPage (怪物一览)
      │  ├─ DayScroll (水平滚动)
      │  ├─ ScanButton (一键识别)
      │  └─ MonsterCard List
      │
      └─ 其他 5 个页面 (占位)
```

## 📦 新增组件

### 1. `NavIcon` - 导航图标按钮
```python
NavIcon("📋", "怪物一览")
```
- 支持选中状态
- 悬浮高亮效果
- 左侧金色边框指示器

### 2. `DayPill` - 天数胶囊按钮
```python
DayPill("Day 10+")
```
- 圆角胶囊形状
- 单选互斥
- 选中时金色渐变

### 3. `MonsterCard` - 怪物卡片
```python
MonsterCard(
    item_id="m1",
    name="哈洛老犬",
    hp=2325,
    max_hp=2325,
    day="Day 10+"
)
```
- 可展开/收起
- 血量条动态显示
- 支持头像图片

### 4. `SettingsDialog` - 设置对话框
```python
dialog = SettingsDialog(current_scale=1.0)
if dialog.exec():
    new_scale = dialog.get_scale()
```
- 缩放滑块
- 实时预览
- 重置功能

## 🎨 视觉特效

### 配色方案
- **主题金色**：#ffcc00 (导航选中、按钮)
- **高亮金色**：#ffdb4d (悬浮状态)
- **背景深色**：#121212 ~ #1a1410 (渐变)
- **边框金色**：rgba(255, 204, 0, 0.1~0.6) (不同透明度)

### 玻璃拟态效果
- 半透明背景
- 细金色边框
- 悬浮时左侧加粗边框
- 渐变背景增强层次

### 扫光按钮
```css
background: qlineargradient(x1:0, y1:0, x2:1, y2:1, 
    stop:0 #2b2621, 
    stop:0.3 #d4af37, 
    stop:0.7 #d4af37, 
    stop:1 #2b2621);
```

## 🔧 使用方法

### 基础启动
```python
from gui.windows.sidebar_window import SidebarWindow

sidebar = SidebarWindow()
sidebar.show()
```

### 设置缩放
```python
sidebar.set_scale(1.5)  # 1.5倍缩放
```

### 监听事件
```python
sidebar.closed.connect(on_sidebar_closed)
```

## 📝 功能清单

### 已实现 ✅
- [x] 左侧导航栏
- [x] 6个功能模块入口
- [x] 水平滚动天数选择器
- [x] 可展开怪物卡片
- [x] 全局缩放系统
- [x] 设置对话框
- [x] 收起/展开功能
- [x] 拖动窗口
- [x] 定位到屏幕右侧

### 待实现 🚧
- [ ] 一键识别功能对接
- [ ] 识别时的流光动画
- [ ] 卡牌识别页面
- [ ] 手头物品页面
- [ ] 百科搜索页面
- [ ] 阵容推荐页面
- [ ] 策略分析页面
- [ ] 缩放比例持久化保存

## 🎯 下一步建议

### 1. 对接识别功能
```python
self.scan_btn.clicked.connect(self._start_scan)

def _start_scan(self):
    # 开始扫描动画
    self.scan_btn.setText("🔍 正在全神贯注...")
    # 调用 YOLO 检测
    # 更新卡片列表
```

### 2. 添加流光动画
使用 `QPropertyAnimation` 实现边框流光效果

### 3. 实现其他页面
逐步填充其他 5 个功能模块

### 4. 数据持久化
保存用户设置（缩放比例、选中天数等）

## 🧪 测试方法

运行测试文件：
```bash
python test_sidebar.py
```

功能测试：
1. ✅ 点击左侧导航切换页面
2. ✅ 滚动天数选择器
3. ✅ 点击怪物卡片展开/收起
4. ✅ 点击设置按钮调整缩放
5. ✅ 点击收起按钮收起侧边栏
6. ✅ 拖动窗口移动位置

## 💡 设计亮点

1. **极简主义**：左侧仅用图标，信息密度极高
2. **空间优化**：天数选择器改为水平滚动，节省垂直空间
3. **渐进披露**：卡片默认紧凑，点击展开详情
4. **全局缩放**：一次调整，所有元素同步适配
5. **游戏感**：金色主题、流光效果、玻璃拟态
6. **响应式**：支持收起为极窄模式

## 📸 视觉预览

```
┌─────────────────────────────────────┐
│  集市小抄               ◀ ✕        │ <- TopBar
├───┬─────────────────────────────────┤
│📦 │ [Day1][Day2]...[Day10+] →      │ <- 天数滚动
│   │                                 │
│📋 │ 🔍 一键识别当前野怪             │ <- 识别按钮
│🎴 │ ┌─────────────────────────┐    │
│🎯 │ │[头像] 哈洛老犬    Day10+ │    │
│📚 │ │❤️ 2325/2325 ████████   │    │ <- 怪物卡片
│🧠 │ └─────────────────────────┘    │
│📊 │ ┌─────────────────────────┐    │
│   │ │[头像] 废犬实验体  Day10+ │    │
│⚙️ │ └─────────────────────────┘    │
│🔍 │                                 │
└───┴─────────────────────────────────┘
```

## 🌟 核心优势

相比原版设计的提升：
- ✨ 更现代化的布局（左右分栏）
- 📱 更好的扩展性（垂直导航可无限增加）
- 🎨 更强的视觉冲击（玻璃拟态 + 金色流光）
- 👥 更好的用户体验（全局缩放 + 收起功能）
- 🚀 更高的信息密度（水平天数 + 可展开卡片）

---

**状态**: ✅ 核心框架完成，可以开始功能对接和内容填充！
